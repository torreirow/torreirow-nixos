groups:
  - name: SSL Alerts TechNative
    rules:
      - alert: SSL Expiration month - TechNative
        expr: (probe_ssl_earliest_cert_expiry - time()) / 86400 < 31
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "SSL certificate expiring soon"
          description: "The certificate {{ $labels.instance }} will expire in less than 31 days"
      - alert: SSL Expiration week - TechNative
        expr: (probe_ssl_earliest_cert_expiry - time()) / 86400 < 7
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "SSL certificate expiring soon"
          description: "The certificate {{ $labels.instance }} will expire in less than 7 days"

